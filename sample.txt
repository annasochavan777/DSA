Import-Module WebAdministration

param (
    [string]$SiteName = "Default Web Site"  # Replace with the name of your IIS site
)

try {
    # Get the application pool associated with the site
    $appPoolName = (Get-Item "IIS:\Sites\$SiteName").applicationPool

    if ($appPoolName) {
        # Fetch the trust level configuration for the application pool
        $trustLevel = Get-WebConfigurationProperty -Filter "system.web/trust" -PSPath "IIS:\Sites\$SiteName" -Name "level"

        Write-Output "Trust Level for '$SiteName': $($trustLevel.Value)"
    } else {
        Write-Host "Application pool for site '$SiteName' not found." -ForegroundColor Yellow
    }
} catch {
    Write-Host "Error: $($_.Exception.Message)" -ForegroundColor Red
}
