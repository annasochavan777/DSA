# Import the WebAdministration module
Import-Module WebAdministration

# Get all websites
Write-Host "Websites:" -ForegroundColor Green
Get-ChildItem IIS:\Sites | ForEach-Object {
    Write-Host "Site Name: $_.Name"
    Write-Host "  State: $_.State"
    Write-Host "  Physical Path: $_.PhysicalPath"
    Write-Host "  Binding Information: " 
    $_.Bindings.Collection | ForEach-Object {
        Write-Host "    Protocol: $($_.protocol), Address: $($_.bindingInformation)"
    }
    Write-Host ""
}

# Get all web applications under each website
Write-Host "Web Applications:" -ForegroundColor Green
Get-ChildItem IIS:\Sites | ForEach-Object {
    $siteName = $_.Name
    Write-Host "Site Name: $siteName"
    Get-ChildItem "IIS:\Sites\$siteName" | Where-Object { $_.PSIsContainer } | ForEach-Object {
        Write-Host "  Application Path: $_.PSChildName"
        Write-Host "  Physical Path: $_.PhysicalPath"
    }
    Write-Host ""
}
