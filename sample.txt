# Import the IIS module
Import-Module WebAdministration

# Function to retrieve all applications under a website
function Get-WebApplications {
    # Iterate through each website in IIS
    Get-ChildItem IIS:\Sites | ForEach-Object {
        $siteName = $_.Name
        Write-Host "Website: $siteName" -ForegroundColor Cyan

        # Get all web applications (exclude root '/' application)
        Get-WebApplication -Site $siteName | ForEach-Object {
            Write-Host "  Application Path: $_.Path"
            Write-Host "  Physical Path: $_.PhysicalPath"
        }
        Write-Host ""
    }
}

# Run the function to list all applications under all websites
Get-WebApplications
