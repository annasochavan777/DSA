# Import the WebAdministration module
Import-Module WebAdministration

# Get all websites and their web applications
Write-Host "Web Applications under Websites:" -ForegroundColor Green
Get-ChildItem IIS:\Sites | ForEach-Object {
    $siteName = $_.Name
    Write-Host "Website: $siteName" -ForegroundColor Cyan

    # Retrieve all child items under the website
    Get-ChildItem "IIS:\Sites\$siteName" | Where-Object { 
        $_.Schema.ClassName -eq "Application" -and $_.PSChildName -ne "/" 
    } | ForEach-Object {
        Write-Host "  Application Path: $_.PSChildName"
        Write-Host "  Physical Path: $_.PhysicalPath"
    }
    Write-Host ""
}
