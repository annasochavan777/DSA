$remoteComputer = "RemoteComputerName"
$serviceName = "YourServiceName"
$domain = "YourDomain"
$username = "YourUsername"
$password = "YourNewPassword"

# Create the credentials object
$securePassword = ConvertTo-SecureString $password -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential ($domain + "\" + $username, $securePassword)

# Get the service information from the remote machine
$service = Get-WmiObject -Class Win32_Service -ComputerName $remoteComputer -Filter "Name = '$serviceName'"

# Prepare the arguments for the Change method
$arguments = @(
    $null,  # Caption (leave it null)
    $null,  # Description (leave it null)
    $null,  # StartMode (leave it null)
    $null,  # ErrorControl (leave it null)
    $creds.UserName,  # New username
    $creds.GetNetworkCredential().Password,  # New password
    $null,  # LoadOrderGroup (leave it null)
    $null   # LoadOrderGroupDependencies (leave it null)
)

# Invoke the method to change the service credentials
$service.InvokeMethod("Change", $arguments)

Write-Host "Password updated successfully for service: $serviceName on $remoteComputer"
