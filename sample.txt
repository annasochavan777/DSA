$remoteComputer = "RemoteComputerName"
$serviceName = "YourServiceName"
$domain = "YourDomain"
$username = "YourUsername"
$password = "YourNewPassword"

# Create the credentials object
$securePassword = ConvertTo-SecureString $password -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential ($domain + "\" + $username, $securePassword)

# Get the service information from the remote machine
$service = Get-WmiObject -Class Win32_Service -ComputerName $remoteComputer -Filter "Name = '$serviceName'"

# Use the Invoke-WmiMethod cmdlet to update service credentials
$service.InvokeMethod("Change", $null, $null, $null, $creds.UserName, $creds.Password)

Write-Host "Password updated successfully for service: $serviceName on $remoteComputer"
