# Define variables
$SourceFile = "C:\path\to\your\file.txt"  # Local file to copy
$TargetPath = "\\RemoteMachine\C$\target\path\file.txt"  # Remote location (use UNC path)
$RemoteComputer = "RemoteMachine"  # Remote computer name
$ServiceName = "YourServiceName"  # Name of the Windows service to restart
$Username = "domain\username"  # If needed, specify a domain user
$Password = "YourPassword"  # Secure handling recommended

# Copy the file to the remote machine
Copy-Item -Path $SourceFile -Destination $TargetPath -Force -ErrorAction Stop
Write-Output "File copied successfully to $TargetPath"

# Restart the Windows service remotely
$SecurePassword = ConvertTo-SecureString $Password -AsPlainText -Force
$Credential = New-Object System.Management.Automation.PSCredential ($Username, $SecurePassword)

Invoke-Command -ComputerName $RemoteComputer -Credential $Credential -ScriptBlock {
    param($ServiceName)
    Restart-Service -Name $ServiceName -Force
    Write-Output "Service $ServiceName restarted successfully on $env:COMPUTERNAME"
} -ArgumentList $ServiceName

Write-Output "Operation completed successfully."
